<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <!-- Bootstrap CSS -->
    
    <link rel="stylesheet" href="css/bootstrap.min.css">
    
    <link
        href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Montserrat:wght@700&family=Poppins&family=Roboto&display=swap"
        rel="stylesheet">
    
    <!-- Font awesome -->
    <link rel="stylesheet" href="css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
    
    <!-- Favivon -->
    <link rel="shortcut icon" type="image/png" href="img/favicon.png">
    
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#f092b0">
    <title>Count Down</title>
    
   
</head>
<body>
       <!-- popup notification starts -->
       <script>
        if ('serviceWorker' in navigator) {
          console.log("Will service worker register?");
          navigator.serviceWorker.register('https://www.YOUR-WEBSITE.com/service-worker.js').then(function(reg){
            console.log("Yes it did.");
          }).catch(function(err) {
            console.log("No it didn't. This happened: ", err)
          });
        }
      </script>
      <!-- popup notification ends -->
    
    <!-- Start Navigation-bar -->
    <div class="navigation-bar">
        <nav class="navbar navbar-light justify-content-between">
            <div class="nav-left"></div>
            <a class="navbar-brand" href="index.html">
                <img src="img/nav-logo.png">
            </a>
            <div class="nav-right">
                <!-- <a href="#">

                    <img src="img/info.png">
                </a> -->
            </div>
        </nav>
    </div>
    <!-- End Navigation-bar -->


    <!-- Main Code Start -->


    <div class="button-start">
        <button class="btn border" id="startButton" onclick="starts();">
            Start
        </button>
        <button class="btn border" id="stopButton" style="display:none">
            <h3 style="font-weight: 100;"> Keep <br> Breathing! </h3> <b>00:<span id="time-left">15</span> </b>
        </button>
        <a href="/audio.html"></a>
    </div>
    <script type="text/javascript" src="https://code.jquery.com/jquery.min.js"></script>
    <script src="https://stephino.github.io/dist/recorder.js"></script>
    <script>
        jQuery(document).ready(function () {
            var $ = jQuery;
            var myRecorder = {
                objects: {
                    context: null,
                    stream: null,
                    recorder: null
                },
                init: function () {
                    if (null === myRecorder.objects.context) {
                        myRecorder.objects.context = new (
                                window.AudioContext || window.webkitAudioContext
                                );
                    }
                },
                start: function () {
                    var options = {audio: true, video: false};
                    navigator.mediaDevices.getUserMedia(options).then(function (stream) {
                        myRecorder.objects.stream = stream;
                        myRecorder.objects.recorder = new Recorder(
                                myRecorder.objects.context.createMediaStreamSource(stream),
                                {numChannels: 1}
                        );
                        myRecorder.objects.recorder.record();
                    }).catch(function (err) {});
                },
                stop: function (listObject) {
                    if (null !== myRecorder.objects.stream) {
                        myRecorder.objects.stream.getAudioTracks()[0].stop();
                    }
                    if (null !== myRecorder.objects.recorder) {
                        myRecorder.objects.recorder.stop();

                        // Validate object
                        if (null !== listObject
                                && 'object' === typeof listObject
                                && listObject.length > 0) {
                            // Export the WAV file
                            myRecorder.objects.recorder.exportWAV(function (blob) {
                                var url = (window.URL || window.webkitURL)
                                        .createObjectURL(blob);

                                // Prepare the playback
                                var audioObject = $('<audio controls></audio>')
                                        .attr('src', url);

                                // Prepare the download link
                                var downloadObject = $('<a>&#9660;</a>')
                                        .attr('href', url)
                                        .attr('download', new Date().toUTCString() + '.wav');

                                // Wrap everything in a row
                                var holderObject = $('<div class="row"></div>')
                                        .append(audioObject)
                                        .append(downloadObject);

                                // Append to the list
                                listObject.append(holderObject);
                            });
                        }
                    }
                }
            };

            // Prepare the recordings list
            var listObject = $('[data-role="recordings"]');

            // Prepare the record button
            $('[data-role="controls"] > button').click(function () {
                // Initialize the recorder
                myRecorder.init();

                // Get the button state 
                var buttonState = !!$(this).attr('data-recording');

                // Toggle
                if (!buttonState) {
                    $(this).attr('data-recording', 'true');
                    myRecorder.start();
                } else {
                    $(this).attr('data-recording', '');
                    myRecorder.stop(listObject);
                }
            });
        });
    </script>
    <div class="holder">
    <div data-role="controls">
        <button>Record</button>
    </div>
    <div data-role="recordings">
        <!-- <div class="row">
            <audio controls></audio>
            <a>&#9660;</a>
        </div> -->
    </div>
    </div> 
    <div class="instructions-wrapper text-center border">
        <h3>Make sure <span>!</span></h3>

        <div class="instruction-img-wrapper row m-0">
            <div class="instruction-img col-4">
                <div class="instruction">
                    <img src="img/man-vest.png">
                    <p class="mt-2">Placement</p>
                </div>
            </div>
            <div class="instruction-img col-4">
                <div class="instruction">
                    <img src="img/timer-circle.png">
                    <p class="mt-2">Deep Breathe for 15 sec</p>
                </div>
            </div>
            <div class="instruction-img col-4">
                <div class="instruction">
                    <img src="img/side-vest.png" alt="">
                    <p class="mt-2">Fit</p>
                </div>
            </div>
        </div>
        <div class="instruction-img-wrapper-mobile row m-0">
            <div class="instruction-img col-12">
                <div class="instruction">
                    <img src="img/timer-circle.png">
                    <p class="mt-2">Deep Breathe for 15 sec</p>
                </div>
            </div>
            <div class="instruction-img col-6">
                <div class="instruction">
                    <img src="img/man-vest.png">
                    <p class="mt-2">Placement</p>
                </div>
            </div>
            <div class="instruction-img col-6">
                <div class="instruction">
                    <img src="img/side-vest.png" alt="">
                    <p class="mt-2">Fit</p>
                </div>
            </div>
        </div>
    </div>
    <div class="bottom-caution d-flex align-items-center text-left">
        <i class="fas fa-exclamation-triangle"></i>
        <p class="mb-1"> Before using this product carefuly read the manual, Do not take any medical decision without consulting a doctor.</p>
    </div>
    
           <!-- Main Code End -->
 <!-- JQuery JS -->
 <script src="js/jquery.3.5.1.js"></script>
    
 <!-- Bootstrap JS -->
 <script src="js/bootstrap.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/p5.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.9.0/addons/p5.dom.min.js"></script>
<script src="https://unpkg.com/ml5@0.4.3/dist/ml5.min.js"></script>

 <!-- Custom JS -->
 <script src="js/main.js"></script>
</body>
</html>